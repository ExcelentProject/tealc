---
- name: Create Argo applications for Strimzi twitter
  kubernetes.core.k8s:
    kubeconfig: "{{ kubeconfig_path }}/{{ infra_context_name }}"
    namespace: "{{ infra_argo_namespace }}"
    state: present
    template: "{{ item }}"
  vars:
    worker_cluster_connection: "{{ workers[0].name }}"
  with_fileglob: 'templates/argo/projects/strimzi-twitter-app/*.j2'

- name: Create Twitter app related Tekton pipelines
  kubernetes.core.k8s:
    kubeconfig: "{{ kubeconfig_path }}/{{ infra_context_name }}"
    namespace: "{{ infra_ci_namespace }}"
    state: present
    src: "{{ item }}"
  with_fileglob: 'files/tekton/pipelines/twitter-app/*.yaml'
